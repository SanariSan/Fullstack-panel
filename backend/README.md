# Vac-Hunter
### Hunt vacancies like a pro

## Table of Contents

- [About](#about)
- [Main structure](#structure)
- [Usage](#usage)

## About <a name = "about"></a>

Fullstack notify utility to let you hunt vacancies as fast as possible.
Features:
- Setting up search queries to be processed in the background 24/7
- Scrapping across multiple platforms (currently hhru only)
- In site notifications, telegram notifications

## Main structure <a name = "structure"></a>

### Общая идея:

- Юзер составляет запросы на мониторинг;
- Вакансии по запросам регулярно парсятся;
- Юзер, когда на сайте, получает уведомления о новых вакансиях (longpoll);
- Юзер в телеграме получает получает уведомления о новых вакансиях (со ссылкой на сайт для их просмотра);

- Возможно юзер включает автоотклик (но это не точно);
- Возможно будут добавлены другие сайты с вакансиями (делается с учетом масштабирования)

---

### Общение фронт > бек | Общение фронта с беком с позиции фронта

Для начала осознаем, что поиск в теории может быть не только по хх.
Хочется на фронте иметь стандартизированные параметры поиска для ЛЮБОГО ресурса, которые уже на беке будут обработаны под целевой сервис.

Может так случиться, что один сервис дает поиск в условном новгороде, другой нет.
Тут придется поэтапно подтягивать с бека service-specific поля.
Предварительно отметив опцию с каким сервисом идет работа.

Это снимает ненужную нагрузку с клиента, форсит иметь с сервером ОДИН стандартизированный формат для вакансии ЛЮБОГО сервиса.

---

На фронт с бека подтягиваются ОБЪЕКТЫ

Среди которых можно:
-Выбрать регион-город
-Выбрать формат работы
-Выбрать опыт работы
По ЧИТАБЕЛЬНОМУ НАЗВАНИЮ, на сервер оно уйдет в виде стандартизированного ID.

Можно передать поисковый запрос, добавить слова исключения.

Если сервисов несколько, то стоит передавать как можно больше параметров в качестве объекта опций, а дальше уже на беке производить их парсинг в зависимости от целевого ресурса.

---

ТАКИМ образом получаем, что фронт запрашивает с бека по каждому параметру поиска объект
```
{
читабельный_формат_опции: название,
параметры_для_отправки_на_бек: id_hash_etc
}
```

Если это город, то идет выбор Регион - Город, в два поочередных парса данных.

---

### Общение фронт < бек | Общение фронта с беком с позиции бека

Бек имеет распаршенные параметры для проведения запроса по каждому сайту. Хранит их, вероятно, в файловой системе, тк забивать бд не хочется (но можно, если нужно).

Первым делом бек смотрит отметку, с каким сайтом будет идти работа.
После чего отдает соответствующие поля с параметрами поиска фронту.

Когда бек получает запрос на создание парса вакансий, смотрится какой сайт должен будет парситься, затем приложенные параметры передаются в очередь, соответствующую данному сайту.

Запуск парса вакансий для каждого поискового запроса в каждом сервисе происходит раз в X минут.
Все парсы для одного сайта происходят поочередно, все парсы в различных сайтов происходят параллельно (разные очереди).

Обработка ответа для парса каждой вакансии - задача отдельного модуля(?). Нет желания смешивать запрос и обработку огромного ответа с проверкой кучи полей + занесением в бд.
В идеале хотелось бы разделить на:

X) Главный сервер, рутинг запросов по сервисам.

1) Сервис отдачи параметров поиска для Каждого сайта.
Ендпоинт - получает сайт, опционально подпараметр, отдает параметры для поиска.

2) Сервис принятия запроса на поиск, передача в нужную очередь (в бд).
Ендпоинт - принятие запроса на поиск, внесение запроса, в зависимости от поля сайта, в бд.

3) Сервисы парсинга Каждого отдельного сайта с очереди из поисковых запросов в бд (подгруз поисковых запросов этому сайту из бд, постановка в локальную очередь-массив (?)).
Ендпоинт - нет. Автономный сервис, отслеживает бд.

4) Сервисы обработки ответов запроса с Каждого отдельного сайта, занесение вакансии в бд.
Ендпоинт - принятие ответ сервиса парсинга сайта, обработка, внесение вакансии в бд.

5) Сервис уведомления пользователя - проверка новых вакансий в бд, отправка уведомлений в телеграм (бг процесс) если включено, отметка что вакансии не просмотрены (сравнение времени просмотра, всегда).
Ендпоинт - отметка что вакансии просмотрены (установка времени просмотра).

6) Сервис выгрузки вакансий с Каждого сайта юзеру по запросу.
Ендпоинт - получить все вакансии, получить новые вакансии.

---

Подобное деление подразумевает микросервисную архитектуру.
Опыта в ее составлении пока нет, по этому СКОРЕЕ всего, для начала, это все будет запихнуто в монолит, после чего, со временем, разлено в отдельные сервисы. 
